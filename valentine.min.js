/*!
  * Valentine: JavaScript's functional Sister
  * (c) Dustin Diaz 2014
  * https://github.com/ded/valentine License MIT
  */
(function(e,t,n){typeof module!="undefined"?module.exports=n():typeof define=="function"?define(n):t[e]=t.v=n()})("valentine",this,function(){function f(e){this.values=e,this.index=0}function l(e,t){return new h(e,t)}function c(e,t){for(var n in t)e[n]=t[n]}function h(e,t){this.val=e,this._scope=t||n,this._chained=0}var e=[],t=Object.prototype.hasOwnProperty,n=null,r=e.slice,i="map"in e,s="reduce"in e,o={each:function(t,n,r){e.forEach.call(t,n,r)},map:function(t,n,r){return e.map.call(t,n,r)},some:function(e,t,n){return e.some(t,n)},every:function(e,t,n){return e.every(t,n)},filter:function(e,t,n){return e.filter(t,n)},indexOf:function(e,t,n){return e.indexOf(t,isFinite(n)?n:0)},lastIndexOf:function(e,t,n){return e.lastIndexOf(t,isFinite(n)?n:e.length)},reduce:function(t,n,r,i){return e.reduce.call(t,n,r,i)},reduceRight:function(t,n,r,i){return e.reduceRight.call(t,n,r,i)},find:function(e,t,n){var r;return o.some(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},reject:function(e,t,n){var r=[];for(var i=0,s=0,o=e.length;i<o;i++)if(i in e){if(t.call(n,e[i],i,e))continue;r[s++]=e[i]}return r},size:function(e){return a.toArray(e).length},compact:function(e){return o.filter(e,function(e){return!!e})},flatten:function(e){return o.reduce(e,function(e,t){return u.arr(t)?e.concat(o.flatten(t)):(e[e.length]=t,e)},[])},uniq:function(e,t){var n=[],r,i;e=t?o.map(e,t):e;e:for(r=0;r<e.length;r++){for(i=0;i<n.length;i++)if(n[i]===e[r])continue e;n[n.length]=e[r]}return n},merge:function(e,t){var n=e.length,r=0,i;if(isFinite(t.length))for(i=t.length;r<i;r++)e[n++]=t[r];else while(t[r]!==undefined)first[n++]=second[r++];return e.length=n,e},inArray:function(e,t){return!!~o.indexOf(e,t)},memo:function(e,n){var r={};return n||(n=function(e){return e}),function(){var i=n.apply(this,arguments);return t.call(r,i)?r[i]:r[i]=e.apply(this,arguments)}}},u={fun:function(e){return typeof e=="function"},str:function(e){return typeof e=="string"},ele:function(e){return!!e&&!!e.nodeType&&e.nodeType==1},arr:function(e){return e instanceof Array},arrLike:function(e){return e&&e.length&&isFinite(e.length)},num:function(e){return typeof e=="number"},bool:function(e){return e===!0||e===!1},args:function(e){return!!e&&!!t.call(e,"callee")},emp:function(e){var t=0;return u.arr(e)?e.length===0:u.obj(e)?function(){for(var n in e){t++;break}return t===0}():e===""},dat:function(e){return!!(e&&e.getTimezoneOffset&&e.setUTCFullYear)},reg:function(e){return!(!(e&&e.test&&e.exec)||!e.ignoreCase&&e.ignoreCase!==!1)},nan:function(e){return e!==e},nil:function(e){return e===n},und:function(e){return typeof e=="undefined"},def:function(e){return typeof e!="undefined"},obj:function(e){return e instanceof Object&&!u.fun(e)&&!u.arr(e)}};u.empty=u.emp,u.date=u.dat,u.regexp=u.reg,u.element=u.ele,u.array=u.arr,u.string=u.str,u.undef=u.und,u.func=u.fun;var a={each:function(n,r,i){u.arrLike(n)?o.each(n,r,i):function(){for(var e in n)t.call(n,e)&&r.call(i,e,n[e],n)}()},map:function(n,r,i){var s=[],a=0;return u.arrLike(n)?o.map(n,r,i):!function(){for(var e in n)t.call(n,e)&&(s[a++]=r.call(i,e,n[e],n))}()&&s},some:function(n,r,i){if(u.arrLike(n))return o.some(n,r,i);for(var s in n)if(t.call(n,s)&&r.call(i,s,n[s],n))return!0;return!1},every:function(n,r,i){if(u.arrLike(n))return o.every(n,r,i);for(var s in n)if(!t.call(n,s)||!r.call(i,s,n[s],n))return!1;return!0},filter:function(n,r,i){var s={},a;if(u.arrLike(n))return o.filter(n,r,i);for(a in n)t.call(n,a)&&r.call(i,a,n[a],n)&&(s[a]=n[a]);return s},pluck:function(t,n){return u.arrLike(t)?o.map(t,function(e){return e[n]}):a.map(t,function(e,t){return t[n]})},toArray:function(t){return t?u.arr(t)?t:t.toArray?t.toArray():u.args(t)?r.call(t):o.map(t,function(e){return e}):[]},first:function(t){return t[0]},last:function(t){return t[t.length-1]},keys:Object.keys,values:function(e){return a.map(e,function(e,t){return t})},extend:function(){var t,r,i,s,o,f=arguments[0],l=1,c=arguments.length;for(;l<c;l++)if((t=arguments[l])!==n)for(r in t){i=f[r],s=t[r];if(f===s)continue;s&&u.obj(s)?(o=i&&u.obj(i)?i:{},f[r]=a.extend(o,s)):s!==undefined&&(f[r]=s)}return f},trim:function(e){return e.trim()},bind:function(e,t){var n=arguments.length>2?r.call(arguments,2):null;return function(){return t.apply(e,n?n.concat(r.call(arguments)):arguments)}},curry:function(t){if(arguments.length==1)return t;var n=r.call(arguments,1);return function(){return t.apply(null,n.concat(r.call(arguments)))}},parallel:function(t,r){var i=a.toArray(arguments),s=0,f=[],l=[];if(u.arr(t)&&t.length===0||u.fun(t)&&i.length===1)throw new TypeError("Empty parallel array");u.arr(t)||(r=i.pop(),t=i),o.each(t,function(e,i){e(function(){var e=a.toArray(arguments),u=e.shift();if(u)return r(u);f[i]=e,t.length==++s&&(f.unshift(n),o.each(f,function(e){l=l.concat(e)}),r.apply(n,l))})})},waterfall:function(t,r){var i=a.toArray(arguments),s=0;if(u.arr(t)&&t.length===0||u.fun(t)&&i.length===1)throw new TypeError("Empty waterfall array");u.arr(t)||(r=i.pop(),t=i),function o(){var e=a.toArray(arguments);e.push(o);var i=e.shift();!i&&t.length?t.shift().apply(n,e):(e.pop(),e.unshift(i),r.apply(n,e))}(n)},queue:function(t){return new f(u.arrLike(t)?t:a.toArray(arguments))},debounce:function(t,n,r){function s(){function o(){i=null,n.apply(s,e)}var e=arguments,s=r||this;clearTimeout(i),i=setTimeout(o,t)}var i;return s.cancel=function(){clearTimeout(i),i=null},s},throttle:function(t,n,r){var i;return function(){var s=r||this,o=arguments;i||(i=setTimeout(function(){n.apply(s,o),i=null},t))}},throttleDebounce:function(e,t,n,r){function a(){i=arguments,s=r||this,clearTimeout(o),o=setTimeout(function(){clearTimeout(u),u=null,n.apply(s,i)},t),u||(u=setTimeout(function(){clearTimeout(o),u=null,n.apply(s,i)},e))}var i,s,o,u;return a.cancel=function(){clearTimeout(o),clearTimeout(u),u=null},a}};return f.prototype.next=function(){return this.index<this.values.length&&this.values[this.index++](),this},c(l,o),c(l,a),l.is=u,l.v=l,l.each(l.extend({},o,a),function(e,t){h.prototype[e]=function(){var e=l.toArray(arguments);e.unshift(this.val);var n=t.apply(this._scope,e);return this.val=n,this._chained?this:n}}),c(h.prototype,{chain:function(){return this._chained=1,this},value:function(){return this.val}}),l})